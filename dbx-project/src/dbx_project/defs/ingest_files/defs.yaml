# dbx_project/defs/ingest_files/defs.yaml

type: dagster_sling.SlingReplicationCollectionComponent

attributes:
  sling:
    connections:
      - name: LOCAL_DUCKDB
        type: duckdb
        instance: "{{ env.LOCAL_DUCKDB_PATH }}"  # Uses your environment variable
      - name: LOCAL
        type: file
      - name: DATABRICKS_TEST
        type: databricks
        catalog: test
        host: "{{ env.DATABRICKS_HOST }}"
        schema: default
        token: "{{ env.DATABRICKS_TOKEN }}"
        warehouse_id: "{{ env.DATABRICKS_WAREHOUSE_ID }}"

  replications:
    -
      path: "{{ 'replication_prod.yaml' if env.DAGSTER_ENV == 'PROD' else 'replication_local.yaml' }}"
      translation:
        group_name: "sling_replication"
        description: "Loads data from Sling replication {{ stream_definition.name }}"
        tags:
          environment: "{{ env.DAGSTER_ENV }}"