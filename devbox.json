{
  "env": {
    "UV_PYTHON": "$PWD/.venv/bin/python",
    "DEVBOX_COREPACK_ENABLED": "1",
    "PGHOST": "/tmp"
  },
  "packages": [
    "python@3.13",
    "nodejs@latest",
    "uv@latest",
    "duckdb@latest",
    "podman@latest",
    "podman-compose@latest",
    "postgresql@latest"
  ],
  "shell": {
    "init_hook": [
      ". $VENV_DIR/bin/activate > /dev/null 2>&1",
      "uv pip install  -r requirements.txt > /dev/null 2>&1",
      "if ! podman machine list | grep -q 'Currently running'; then podman machine start > /dev/null 2>&1; fi",
      "# --- PostgreSQL Server Management ---",
      "mkdir -p .devbox/var/log",
      "if [ ! -d \".devbox/var/lib/postgres/base\" ]; then initdb -D .devbox/var/lib/postgres; fi",
      "pg_ctl status -D .devbox/var/lib/postgres > /dev/null 2>&1 || (pg_ctl -D .devbox/var/lib/postgres -l .devbox/var/log/postgres.log -w start)"
    ]
  }
}
